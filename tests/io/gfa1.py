#!/usr/bin/env python3

"""tests.io.gfa1.py: Fragments of GFA1 files"""

import pandas as pd
import numpy as np


from exfi.io.gfa1 import \
    HEADER_COLS, SEGMENT_COLS, LINK_COLS, CONTAINMENT_COLS, PATH_COLS, \
    HEADER_DTYPES, SEGMENT_DTYPES, LINK_DTYPES, CONTAINMENT_DTYPES, PATH_DTYPES

HEADER = pd.DataFrame(
    data=[["H", "VN:Z:1.0"]],
    columns=HEADER_COLS
).astype(HEADER_DTYPES)



SEGMENTS_EMPTY = pd.DataFrame(
    columns=SEGMENT_COLS
).astype(SEGMENT_DTYPES)

SEGMENTS_SIMPLE = pd.DataFrame(
    data=[[
        "S",
        "ENSDART00000161035.1:0-326",
        "TGCACGGGTTTATTGTTCACAAAGAGATCGACAATGTGCGCAACTAAAATAAACATAGTACATTTTGATT"
        "ATACACGAACTTAAACTAAAGTCCAATCACACCTCCGCCCCGTTTCCACAGCAGCCTGTCAGGGTGGAGG"
        "AAAAGCGCGGCGGTCATGTGAGGCTCGAGCATCTCTCTCTCTCTCTCTCTCTCTCTCTCTACAGAATGAT"
        "AGAGGGAGCTCGTGAATCACATCATAGTCGTCCTCCCCTCATTCGTCCTCTCCAGCAGACACCGAAAAAC"
        "TGCGTTCATGCCAAAATGGGATGTGGAAATTCCTCCGCCACGAGCA"
        ]],
    columns=SEGMENT_COLS
).astype(SEGMENT_DTYPES)

SEGMENTS_COMPLEX = pd.DataFrame(
    data=[[
        "S",
        "ENSDART00000161035.1:0-326",
        "TGCACGGGTTTATTGTTCACAAAGAGATCGACAATGTGCGCAACTAAAATAAACATAGTACATTTTGATT"
        "ATACACGAACTTAAACTAAAGTCCAATCACACCTCCGCCCCGTTTCCACAGCAGCCTGTCAGGGTGGAGG"
        "AAAAGCGCGGCGGTCATGTGAGGCTCGAGCATCTCTCTCTCTCTCTCTCTCTCTCTCTCTACAGAATGAT"
        "AGAGGGAGCTCGTGAATCACATCATAGTCGTCCTCCCCTCATTCGTCCTCTCCAGCAGACACCGAAAAAC"
        "TGCGTTCATGCCAAAATGGGATGTGGAAATTCCTCCGCCACGAGCA",
    ], [
        "S",
        "ENSDART00000161035.1:397-472",
        "AGGAACTACGGTGGAGTGTATGTGGGTCTTCCTGCTGATCTGACTGCAGTCGCTGCCAGTCAGTCCAAAT"
        "CAACA"
    ], [
        "S",
        "ENSDART00000161035.1:477-523",
        "AGTCAACAGATGTTTATTGCAGACCTTCAGATAAAACAACATAGAA"
    ], [
        "S",
        "ENSDART00000165342.1:5-127",
        "TGGAGCTGAAGCCGAGTATCTTGGTATTGGACTGGAACAGAAATCCAGCAAAAACTTTAAGGGAAATCAC"
        "TTTCATTTCATGATCGAAAAACTCCCGCAGATCATAAAAGAGTGGAAGGAAG"
    ], [
        "S",
        "ENSDART00000165342.1:125-304",
        "AGGACCTGTAGTAGAAACAAAACTAGGATCTCTGAGAGGTGCCTTCTTGACTGTGAAGGGCAAGGACACA"
        "ATAGTCAATAGTTATCTAGGTGTGCCGTTCGCCAAGCCGCCTGTAGGACCCCTGAGACTTGCTCGACCAC"
        "AGGCTGCAGAGAAATGGCAAGGAGTTAGAGATGCCACCA"
    ], [
        "S",
        "ENSDART00000165342.1:317-460",
        "GTGCCTCCAGGAAAGGCAAATGACTGTAACTGAACTGGAGTTTCTATCGATGGATGTGGAGGTTCCTGAG"
        "GTCTCGGAGGATTGCCTGTATCTTAACATCTACACCCCAGTTAAACCTGGACAAGGAGACAAGAAGTTAC"
        "CAG"
    ], [
        "S",
        "ENSDART00000165342.1:459-592",
        "GTCATGGTTTGGATTCATGGTGGAGGACTCTCTCTTGGATCGGCTTCAATGTATGATGGCTCTGTTCTGG"
        "CTGCGTATCAGGATGTGGTCGTGGTGCTCATTCAGTACAGATTGGGTCTTCTGGGGTTCTTAA"
    ], [
        "S",
        "ENSDART00000165342.1:591-650",
        "AGCACCGGAGACGAGCATGCGCCAGGAAACTATGGTTTTCTGGATCAAGTAGCTGCCCT"
    ], [
        "S",
        "ENSDART00000165342.1:645-746",
        "GCCCTTCAGTGGGTTCAGGAGAACATCCACAGCTTCGGTGGAGATCCTGGATCAGTGACCATCTTTGGAG"
        "AGTCTGCTGGAGGAATCAGTGTATCCACGCT"
    ], [
        "S",
        "ENSDART00000165342.1:746-851",
        "GATTCTTTCCCCGCTGGCGTCTGGACTGTTTCATCGCGCCATTGCAGAAAGTGGAACTGCCTTCTGGGAT"
        "GGTTTAGTCATGGCTGATCCTTTTCAGAGAGCCCA"
    ], [
        "S",
        "ENSDART00000165342.1:854-886",
        "TGCAGCCAAACAATGCAACTGTGACAGCAGCA"
    ], [
        "S",
        "ENSDART00000165342.1:899-953",
        "TGTCGACTGCATTATGCACTGGTCTGAAGAGGAGGCTCTGGAATGTGCTAAAAA"
    ], [
        "S",
        "ENSDART00000165342.1:974-1097",
        "CGTTGCTGTAGATTCTTATTTCCTTCCCAAACCCATCGAGGAGATTGTTGAGAAACAAGAGTTTAGTAAA"
        "GTTCCTCTCATCAACGGCATTAACAATGATGAGTTTGGCTTCTTGTTGGCTGA"
    ], [
        "S",
        "ENSDART00000165342.1:1098-1175",
        "TATTTCTTGGGTCCTGAATGGATGAATGGGTTGAAAAGAGAGCAAATCGCTGAAGCCTTGACGCTCACAT"
        "ATCCTGA"
    ], [
        "S",
        "ENSDART00000165342.1:1176-1324",
        "CCCAAGGATCGATGGATCATTGATCTGGTGGCGAAGGAATATCTGGGCGACACACACGACCCCATTGAAA"
        "TCCGTGAAGTTTATCGGGAGATGATGGGAGACGTGCTGTTTAACATCCCTGCCCTGCAACTGGCAAAACA"
        "CCACAGCG"
    ]],
    columns=SEGMENT_COLS
).astype(SEGMENT_DTYPES)

SEGMENTS_COMPLEX_SOFT = pd.DataFrame(
    data=[[
        "S",
        "ENSDART00000161035.1:0-326",
        "TGCACGGGTTTATTGTTCACAAAGAGATCGACAATGTGCGCAACTAAAATAAACATAGTACATTTTGATT"
        "ATACACGAACTTAAACTAAAGTCCAATCACACCTCCGCCCCGTTTCCACAGCAGCCTGTCAGGGTGGAGG"
        "AAAAGCGCGGCGGTCATGTGAGGCTCGAGCATCTCTCTCTCTCTCTCTCTCTCTCTCTCTACAGAATGAT"
        "AGAGGGAGCTCGTGAATCACATCATAGTCGTCCTCCCCTCATTCGTCCTCTCCAGCAGACACCGAAAAAC"
        "TGCGTTCATGCCAAAATGGGATGTGGAAATTCCTCCGCCACGAGCA"
    ], [
        "S",
        "ENSDART00000161035.1:397-472",
        "AGGAACTACGGTGGAGTGTATGTGGGTCTTCCTGCTGATCTGACTGCAGTCGCTGCCAGTCAGTCCAAAT"
        "CAACA"
    ], [
        "S",
        "ENSDART00000161035.1:477-523",
        "AGTCAACAGATGTTTATTGCAGACCTTCAGATAAAACAACATAGAA"
    ], [
        "S",
        "ENSDART00000165342.1:5-127",
        "TGGAGCTGAAGCCGAGTATCTTGGTATTGGACTGGAACAGAAATCCAGCAAAAACTTTAAGGGAAATCAC"
        "TTTCATTTCATGATCGAAAAACTCCCGCAGATCATAAAAGAGTGGAAGGAag"
    ], [
        "S",
        "ENSDART00000165342.1:125-304",
        "agGACCTGTAGTAGAAACAAAACTAGGATCTCTGAGAGGTGCCTTCTTGACTGTGAAGGGCAAGGACACA"
        "ATAGTCAATAGTTATCTAGGTGTGCCGTTCGCCAAGCCGCCTGTAGGACCCCTGAGACTTGCTCGACCAC"
        "AGGCTGCAGAGAAATGGCAAGGAGTTAGAGATGCCACCA"
    ], [
        "S",
        "ENSDART00000165342.1:317-460",
        "GTGCCTCCAGGAAAGGCAAATGACTGTAACTGAACTGGAGTTTCTATCGATGGATGTGGAGGTTCCTGAG"
        "GTCTCGGAGGATTGCCTGTATCTTAACATCTACACCCCAGTTAAACCTGGACAAGGAGACAAGAAGTTAC"
        "CAg"
    ], [
        "S",
        "ENSDART00000165342.1:459-592",
        "gTCATGGTTTGGATTCATGGTGGAGGACTCTCTCTTGGATCGGCTTCAATGTATGATGGCTCTGTTCTGG"
        "CTGCGTATCAGGATGTGGTCGTGGTGCTCATTCAGTACAGATTGGGTCTTCTGGGGTTCTTAa"
    ], [
        "S",
        "ENSDART00000165342.1:591-650",
        "aGCACCGGAGACGAGCATGCGCCAGGAAACTATGGTTTTCTGGATCAAGTAGCTgccct"
    ], [
        "S",
        "ENSDART00000165342.1:645-746",
        "gccctTCAGTGGGTTCAGGAGAACATCCACAGCTTCGGTGGAGATCCTGGATCAGTGACCATCTTTGGAG"
        "AGTCTGCTGGAGGAATCAGTGTATCCACGCT"
    ], [
        "S",
        "ENSDART00000165342.1:746-851",
        "GATTCTTTCCCCGCTGGCGTCTGGACTGTTTCATCGCGCCATTGCAGAAAGTGGAACTGCCTTCTGGGAT"
        "GGTTTAGTCATGGCTGATCCTTTTCAGAGAGCCCA"
    ], [
        "S",
        "ENSDART00000165342.1:854-886",
        "TGCAGCCAAACAATGCAACTGTGACAGCAGCA"
    ], [
        "S",
        "ENSDART00000165342.1:899-953",
        "TGTCGACTGCATTATGCACTGGTCTGAAGAGGAGGCTCTGGAATGTGCTAAAAA"
    ], [
        "S",
        "ENSDART00000165342.1:974-1097",
        "CGTTGCTGTAGATTCTTATTTCCTTCCCAAACCCATCGAGGAGATTGTTGAGAAACAAGAGTTTAGTAAA"
        "GTTCCTCTCATCAACGGCATTAACAATGATGAGTTTGGCTTCTTGTTGGCTGA"
    ], [
        "S",
        "ENSDART00000165342.1:1098-1175",
        "TATTTCTTGGGTCCTGAATGGATGAATGGGTTGAAAAGAGAGCAAATCGCTGAAGCCTTGACGCTCACAT"
        "ATCCTGA"
    ], [
        "S",
        "ENSDART00000165342.1:1176-1324",
        "CCCAAGGATCGATGGATCATTGATCTGGTGGCGAAGGAATATCTGGGCGACACACACGACCCCATTGAAA"
        "TCCGTGAAGTTTATCGGGAGATGATGGGAGACGTGCTGTTTAACATCCCTGCCCTGCAACTGGCAAAACA"
        "CCACAGCG"
    ]],
    columns=SEGMENT_COLS
).astype(SEGMENT_DTYPES)

SEGMENTS_COMPLEX_HARD = pd.DataFrame(
    data=[[
        "S",
        "ENSDART00000161035.1:0-326",
        "TGCACGGGTTTATTGTTCACAAAGAGATCGACAATGTGCGCAACTAAAATAAACATAGTACATTTTGATT"
        "ATACACGAACTTAAACTAAAGTCCAATCACACCTCCGCCCCGTTTCCACAGCAGCCTGTCAGGGTGGAGG"
        "AAAAGCGCGGCGGTCATGTGAGGCTCGAGCATCTCTCTCTCTCTCTCTCTCTCTCTCTCTACAGAATGAT"
        "AGAGGGAGCTCGTGAATCACATCATAGTCGTCCTCCCCTCATTCGTCCTCTCCAGCAGACACCGAAAAAC"
        "TGCGTTCATGCCAAAATGGGATGTGGAAATTCCTCCGCCACGAGCA"
    ], [
        "S",
        "ENSDART00000161035.1:397-472",
        "AGGAACTACGGTGGAGTGTATGTGGGTCTTCCTGCTGATCTGACTGCAGTCGCTGCCAGTCAGTCCAAAT"
        "CAACA"
    ], [
        "S",
        "ENSDART00000161035.1:477-523",
        "AGTCAACAGATGTTTATTGCAGACCTTCAGATAAAACAACATAGAA"
    ], [
        "S",
        "ENSDART00000165342.1:5-127",
        "TGGAGCTGAAGCCGAGTATCTTGGTATTGGACTGGAACAGAAATCCAGCAAAAACTTTAAGGGAAATCAC"
        "TTTCATTTCATGATCGAAAAACTCCCGCAGATCATAAAAGAGTGGAAGGANN"
    ], [
        "S",
        "ENSDART00000165342.1:125-304",
        "NNGACCTGTAGTAGAAACAAAACTAGGATCTCTGAGAGGTGCCTTCTTGACTGTGAAGGGCAAGGACACA"
        "ATAGTCAATAGTTATCTAGGTGTGCCGTTCGCCAAGCCGCCTGTAGGACCCCTGAGACTTGCTCGACCAC"
        "AGGCTGCAGAGAAATGGCAAGGAGTTAGAGATGCCACCA"
    ], [
        "S",
        "ENSDART00000165342.1:317-460",
        "GTGCCTCCAGGAAAGGCAAATGACTGTAACTGAACTGGAGTTTCTATCGATGGATGTGGAGGTTCCTGAG"
        "GTCTCGGAGGATTGCCTGTATCTTAACATCTACACCCCAGTTAAACCTGGACAAGGAGACAAGAAGTTAC"
        "CAN"
    ], [
        "S",
        "ENSDART00000165342.1:459-592",
        "NTCATGGTTTGGATTCATGGTGGAGGACTCTCTCTTGGATCGGCTTCAATGTATGATGGCTCTGTTCTGG"
        "CTGCGTATCAGGATGTGGTCGTGGTGCTCATTCAGTACAGATTGGGTCTTCTGGGGTTCTTAN"
    ], [
        "S",
        "ENSDART00000165342.1:591-650",
        "NGCACCGGAGACGAGCATGCGCCAGGAAACTATGGTTTTCTGGATCAAGTAGCTNNNNN"
    ], [
        "S",
        "ENSDART00000165342.1:645-746",
        "NNNNNTCAGTGGGTTCAGGAGAACATCCACAGCTTCGGTGGAGATCCTGGATCAGTGACCATCTTTGGAG"
        "AGTCTGCTGGAGGAATCAGTGTATCCACGCT"
    ], [
        "S",
        "ENSDART00000165342.1:746-851",
        "GATTCTTTCCCCGCTGGCGTCTGGACTGTTTCATCGCGCCATTGCAGAAAGTGGAACTGCCTTCTGGGAT"
        "GGTTTAGTCATGGCTGATCCTTTTCAGAGAGCCCA"
    ], [
        "S",
        "ENSDART00000165342.1:854-886",
        "TGCAGCCAAACAATGCAACTGTGACAGCAGCA"
    ], [
        "S",
        "ENSDART00000165342.1:899-953",
        "TGTCGACTGCATTATGCACTGGTCTGAAGAGGAGGCTCTGGAATGTGCTAAAAA"
    ], [
        "S",
        "ENSDART00000165342.1:974-1097",
        "CGTTGCTGTAGATTCTTATTTCCTTCCCAAACCCATCGAGGAGATTGTTGAGAAACAAGAGTTTAGTAAA"
        "GTTCCTCTCATCAACGGCATTAACAATGATGAGTTTGGCTTCTTGTTGGCTGA"
    ], [
        "S",
        "ENSDART00000165342.1:1098-1175",
        "TATTTCTTGGGTCCTGAATGGATGAATGGGTTGAAAAGAGAGCAAATCGCTGAAGCCTTGACGCTCACAT"
        "ATCCTGA"
    ], [
        "S",
        "ENSDART00000165342.1:1176-1324",
        "CCCAAGGATCGATGGATCATTGATCTGGTGGCGAAGGAATATCTGGGCGACACACACGACCCCATTGAAA"
        "TCCGTGAAGTTTATCGGGAGATGATGGGAGACGTGCTGTTTAACATCCCTGCCCTGCAACTGGCAAAACA"
        "CCACAGCG"
    ]],
    columns=SEGMENT_COLS
).astype(SEGMENT_DTYPES)




LINKS_EMPTY = pd.DataFrame(
    columns=LINK_COLS
).astype(LINK_DTYPES)

LINKS_SIMPLE = pd.DataFrame(
    columns=LINK_COLS
).astype(LINK_DTYPES)

LINKS_COMPLEX = pd.DataFrame(
    data=[[
        "L", "ENSDART00000161035.1:0-326", "+",
        "ENSDART00000161035.1:397-472", "+", "71N"
    ], [
        "L", "ENSDART00000161035.1:397-472", "+",
        "ENSDART00000161035.1:477-523", "+", "5N"
    ], [
        "L", "ENSDART00000165342.1:5-127", "+",
        "ENSDART00000165342.1:125-304", "+", "2M"
    ], [
        "L", "ENSDART00000165342.1:125-304", "+",
        "ENSDART00000165342.1:317-460", "+", "13N"
    ], [
        "L", "ENSDART00000165342.1:317-460", "+",
        "ENSDART00000165342.1:459-592", "+", "1M"
    ], [
        "L", "ENSDART00000165342.1:459-592", "+",
        "ENSDART00000165342.1:591-650", "+", "1M"
    ], [
        "L", "ENSDART00000165342.1:591-650", "+",
        "ENSDART00000165342.1:645-746", "+", "5M"
    ], [
        "L", "ENSDART00000165342.1:645-746", "+",
        "ENSDART00000165342.1:746-851", "+", "0M"
    ], [
        "L", "ENSDART00000165342.1:746-851", "+",
        "ENSDART00000165342.1:854-886", "+", "3N"
    ], [
        "L", "ENSDART00000165342.1:854-886", "+",
        "ENSDART00000165342.1:899-953", "+", "13N"
    ], [
        "L", "ENSDART00000165342.1:899-953", "+",
        "ENSDART00000165342.1:974-1097", "+", "21N"
    ], [
        "L", "ENSDART00000165342.1:974-1097", "+",
        "ENSDART00000165342.1:1098-1175", "+", "1N"
    ], [
        "L", "ENSDART00000165342.1:1098-1175", "+",
        "ENSDART00000165342.1:1176-1324", "+", "1N"
    ]],
    columns=LINK_COLS
).astype(LINK_DTYPES)



CONTAINMENTS_EMPTY = pd.DataFrame(
    columns=CONTAINMENT_COLS
).astype(CONTAINMENT_DTYPES)

CONTAINMENTS_SIMPLE = pd.DataFrame(
    data=[[
        "C", "ENSDART00000161035.1", "+", "ENSDART00000161035.1:0-326", "+",
        0, "326M"
    ]],
    columns=CONTAINMENT_COLS
).astype(CONTAINMENT_DTYPES)

CONTAINMENTS_COMPLEX = pd.DataFrame(
    data=[[
        "C", "ENSDART00000161035.1", "+", "ENSDART00000161035.1:0-326", "+",
        0, "326M"
    ], [
        "C", "ENSDART00000161035.1", "+", "ENSDART00000161035.1:397-472", "+",
        397, "75M"
    ], [
        "C", "ENSDART00000161035.1", "+", "ENSDART00000161035.1:477-523", "+",
        477, "46M"
    ], [
        "C", "ENSDART00000165342.1", "+", "ENSDART00000165342.1:5-127", "+",
        5, "122M"
    ], [
        "C", "ENSDART00000165342.1", "+", "ENSDART00000165342.1:125-304", "+",
        125, "179M"
    ], [
        "C", "ENSDART00000165342.1", "+", "ENSDART00000165342.1:317-460", "+",
        317, "143M"
    ], [
        "C", "ENSDART00000165342.1", "+", "ENSDART00000165342.1:459-592", "+",
        459, "133M"
    ], [
        "C", "ENSDART00000165342.1", "+", "ENSDART00000165342.1:591-650", "+",
        591, "59M"
    ], [
        "C", "ENSDART00000165342.1", "+", "ENSDART00000165342.1:645-746", "+",
        645, "101M"
    ], [
        "C", "ENSDART00000165342.1", "+", "ENSDART00000165342.1:746-851", "+",
        746, "105M"
    ], [
        "C", "ENSDART00000165342.1", "+", "ENSDART00000165342.1:854-886", "+",
        854, "32M"
    ], [
        "C", "ENSDART00000165342.1", "+", "ENSDART00000165342.1:899-953", "+",
        899, "54M"
    ], [
        "C", "ENSDART00000165342.1", "+", "ENSDART00000165342.1:974-1097", "+",
        974, "123M"
    ], [
        "C", "ENSDART00000165342.1", "+", "ENSDART00000165342.1:1098-1175",
        "+", 1098, "77M"
    ], [
        "C", "ENSDART00000165342.1", "+", "ENSDART00000165342.1:1176-1324",
        "+", 1176, "148M"
    ]],
    columns=CONTAINMENT_COLS
).astype(CONTAINMENT_DTYPES)


PATHS_EMPTY = pd.DataFrame(
    columns=PATH_COLS
).astype(PATH_DTYPES)
PATHS_SIMPLE = pd.DataFrame(
    data=[["P", "ENSDART00000161035.1", "ENSDART00000161035.1:0-326+", "*"]],
    columns=PATH_COLS
).astype(PATH_DTYPES)
PATHS_COMPLEX = pd.DataFrame(
    data=[[
        "P", "ENSDART00000161035.1",
        "ENSDART00000161035.1:0-326+,"
        "ENSDART00000161035.1:397-472+,"
        "ENSDART00000161035.1:477-523+",
        "*"
    ], [
        "P", "ENSDART00000165342.1",
        "ENSDART00000165342.1:5-127+,ENSDART00000165342.1:125-304+,"
        "ENSDART00000165342.1:317-460+,ENSDART00000165342.1:459-592+,"
        "ENSDART00000165342.1:591-650+,ENSDART00000165342.1:645-746+,"
        "ENSDART00000165342.1:746-851+,ENSDART00000165342.1:854-886+,"
        "ENSDART00000165342.1:899-953+,ENSDART00000165342.1:974-1097+,"
        "ENSDART00000165342.1:1098-1175+,ENSDART00000165342.1:1176-1324+",
        "*"
    ]],
    columns=PATH_COLS
).astype(PATH_DTYPES)

GFA1_EMPTY_FN = "tests/io/empty.gfa"
GFA1_SIMPLE_FN = "tests/io/simple.gfa"
GFA1_COMPLEX_FN = "tests/io/complex.gfa"
GFA1_COMPLEX_SOFT_FN = "tests/io/complex_soft.gfa"
GFA1_COMPLEX_HARD_FN = "tests/io/complex_hard.gfa"
